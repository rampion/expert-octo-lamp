<svg
  xmlns="http://www.w3.org/2000/svg"
  height="512"
  width="864">

  <style>
    :root {
      --light-grey: #a0a0a0;
    }

    #grid {
      display: none;
    }

    #grid > g {
      stroke-opacity: 0.1;
    }

    #type-row {
      stroke-width: 2;
      stroke-dasharray: 10 4;
      stroke: var(--light-grey);
    }

    #types text {
      font-family: monospace;
      font-weight: bold;
      dominant-baseline: middle;
      fill: var(--light-grey);
    }

    .tree text {
      font-style: italic;
      dominant-baseline: middle;
      fill: black;
      text-anchor: middle;
    }

    .tree circle, .tree path, .tree line {
      stroke-width: 2;
      stroke: black;
      fill: white;
    }

    .tree .constructor {
      text-anchor: end;
    }
  </style>

  <!-- background grid -->
  <g id="grid">
    <g>
      <line stroke="blue" id="grid-column" y2="512"/>
      <use href="#grid-column" x="32" />
      <use href="#grid-column" x="64" />
      <use href="#grid-column" x="96" />
      <use href="#grid-column" x="128"/>
      <use href="#grid-column" x="160"/>
      <use href="#grid-column" x="192"/>
      <use href="#grid-column" x="224"/>
      <use href="#grid-column" x="256"/>
      <use href="#grid-column" x="288"/>
      <use href="#grid-column" x="320"/>
      <use href="#grid-column" x="352"/>
      <use href="#grid-column" x="384"/>
      <use href="#grid-column" x="416"/>
      <use href="#grid-column" x="448"/>
      <use href="#grid-column" x="480"/>
      <use href="#grid-column" x="512"/>
      <use href="#grid-column" x="544"/>
      <use href="#grid-column" x="576"/>
      <use href="#grid-column" x="608"/>
      <use href="#grid-column" x="640"/>
      <use href="#grid-column" x="672"/>
      <use href="#grid-column" x="704"/>
      <use href="#grid-column" x="736"/>
      <use href="#grid-column" x="768"/>
      <use href="#grid-column" x="800"/>
      <use href="#grid-column" x="832"/>
      <use href="#grid-column" x="864"/>
    </g>

    <g>
      <line stroke="red" id="grid-row" x2="864"/>
      <use href="#grid-row" y="32"/>
      <use href="#grid-row" y="64"/>
      <use href="#grid-row" y="96"/>
      <use href="#grid-row" y="128"/>
      <use href="#grid-row" y="160"/>
      <use href="#grid-row" y="192"/>
      <use href="#grid-row" y="224"/>
      <use href="#grid-row" y="256"/>
      <use href="#grid-row" y="288"/>
      <use href="#grid-row" y="320"/>
      <use href="#grid-row" y="352"/>
      <use href="#grid-row" y="384"/>
      <use href="#grid-row" y="416"/>
      <use href="#grid-row" y="448"/>
      <use href="#grid-row" y="480"/>
      <use href="#grid-row" y="512"/>
    </g>
  </g>

  <g id="types">
    <defs>
      <line id="type-row" x2="864"/>
    </defs>

    <use href="#type-row" y="64"/>
    <use href="#type-row" y="128"/>
    <use href="#type-row" y="192"/>
    <use href="#type-row" y="256"/>
    <use href="#type-row" y="320"/>
    <use href="#type-row" y="384"/>
    <use href="#type-row" y="448"/>

    <text x="512" y="34">:: a</text>
    <text x="512" y="98">:: (a,a)</text>
    <text x="512" y="162">:: ((a,a),(a,a))</text>
    <text x="512" y="226">:: (((a,a),(a,a)),((a,a),(a,a)))</text>
    <text x="512" y="290">:: BalancedTree (((a,a),(a,a)),((a,a),(a,a)))</text>
    <text x="512" y="354">:: BalancedTree ((a,a),(a,a))</text>
    <text x="512" y="418">:: BalancedTree (a,a)</text>
    <text x="512" y="482">:: BalancedTree a</text>

  </g>

  <defs>
    <!-- triangle for arrow head -->
    <marker
      id="arrow"
      viewBox="0 0 10 10"
      refX="5"
      refY="5"
      markerWidth="4"
      markerHeight="4"
      orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" />
    </marker>
    <!-- ball for arrow tail -->
    <marker
      id="ball"
      viewBox="0 0 10 10"
      refX="5"
      refY="5"
      markerWidth="4"
      markerHeight="4"
      orient="auto-start-reverse">
      <circle cx="5" cy="5" r="5"/>
    </marker>
    <g id="canopy" class="tree">
      <path d="M -48 -16 l 48 0 a 16 16 180 1 1 0 32 l -48 0 a 16 16 180 1 1 0 -32"/>"
      <text x="-8" y="2" class="constructor">Canopy</text>

      <line y2="-42" marker-start="url(#ball)" marker-end="url(#arrow)" />
    </g>

    <g id="pair" class="tree">
      <path d="M -12 -16 l 24 0 a 16 16 180 1 1 0 32 l -24 0 a 16 16 180 1 1 0 -32"/>
      <text y="2">(   ,   )</text>

      <line x1="-8" x2="-30" y2="-42" marker-start="url(#ball)" marker-end="url(#arrow)" />
      <line x1="8" x2="30" y2="-42" marker-start="url(#ball)" marker-end="url(#arrow)" />
    </g>

    <g id="pair2" class="tree">
      <path d="M -12 -16 l 24 0 a 16 16 180 1 1 0 32 l -24 0 a 16 16 180 1 1 0 -32"/>
      <text y="2">(   ,   )</text>

      <line x1="-8" x2="-60" y2="-42" marker-start="url(#ball)" marker-end="url(#arrow)" />
      <line x1="8" x2="60" y2="-42" marker-start="url(#ball)" marker-end="url(#arrow)" />
    </g>

    <g id="pair4" class="tree">
      <path d="M -12 -16 l 24 0 a 16 16 180 1 1 0 32 l -24 0 a 16 16 180 1 1 0 -32"/>
      <text y="2">(   ,   )</text>

      <line x1="-8" x2="-120" y2="-42" marker-start="url(#ball)" marker-end="url(#arrow)" />
      <line x1="8" x2="120" y2="-42" marker-start="url(#ball)" marker-end="url(#arrow)" />
    </g>

    <g id="trunk" class="tree">
      <path d="M -36 -16 l 36 0 a 16 16 180 1 1 0 32 l -36 0 a 16 16 180 1 1 0 -32"/>
      <text x="-8" y="2" class="constructor">Trunk</text>

      <line y2="-42" marker-start="url(#ball)" marker-end="url(#arrow)" />
    </g>

    <g class="tree" id="a₀">
      <circle r="16"/>
      <text>a₀</text>
    </g>

    <g class="tree" id="a₁">
      <circle r="16"/>
      <text>a₁</text>
    </g>

    <g class="tree" id="a₂">
      <circle r="16"/>
      <text>a₂</text>
    </g>

    <g class="tree" id="a₃">
      <circle r="16"/>
      <text>a₃</text>
    </g>

    <g class="tree" id="a₄">
      <circle r="16"/>
      <text>a₄</text>
    </g>

    <g class="tree" id="a₅">
      <circle r="16"/>
      <text>a₅</text>
    </g>

    <g class="tree" id="a₆">
      <circle r="16"/>
      <text>a₆</text>
    </g>

    <g class="tree" id="a₇">
      <circle r="16"/>
      <text>a₇</text>
    </g>
  </defs>

  <g class="tree">
    <use href="#a₀" x="32" y="32"/>
    <use href="#a₁" x="96" y="32"/>
    <use href="#a₂" x="160" y="32"/>
    <use href="#a₃" x="224" y="32"/>
    <use href="#a₄" x="288" y="32"/>
    <use href="#a₅" x="352" y="32"/>
    <use href="#a₆" x="416" y="32"/>
    <use href="#a₇" x="480" y="32"/>

    <use x="64" y="96" href="#pair"/>
    <use x="192" y="96" href="#pair"/>
    <use x="320" y="96" href="#pair"/>
    <use x="448" y="96" href="#pair"/>

    <use x="128" y="160" href="#pair2"/>
    <use x="384" y="160" href="#pair2"/>

    <use x="256" y="224" href="#pair4"/>

    <use x="256" y="288" href="#canopy"/>
    <use x="256" y="352" href="#trunk"/>
    <use x="256" y="416" href="#trunk"/>
    <use x="256" y="480" href="#trunk"/>
  </g>
</svg>
